"use strict";void 0===THREE.LoaderSupport&&(THREE.LoaderSupport={}),THREE.LoaderSupport.Validator={isValid:function(e){return null!=e},verifyInput:function(e,r){return null==e?r:e}},THREE.LoaderSupport.Callbacks=function(){this.onProgress=null,this.onReportError=null,this.onMeshAlter=null,this.onLoad=null,this.onLoadMaterials=null},THREE.LoaderSupport.Callbacks.prototype={constructor:THREE.LoaderSupport.Callbacks,setCallbackOnProgress:function(e){this.onProgress=THREE.LoaderSupport.Validator.verifyInput(e,this.onProgress)},setCallbackOnReportError:function(e){this.onReportError=THREE.LoaderSupport.Validator.verifyInput(e,this.onReportError)},setCallbackOnMeshAlter:function(e){this.onMeshAlter=THREE.LoaderSupport.Validator.verifyInput(e,this.onMeshAlter)},setCallbackOnLoad:function(e){this.onLoad=THREE.LoaderSupport.Validator.verifyInput(e,this.onLoad)},setCallbackOnLoadMaterials:function(e){this.onLoadMaterials=THREE.LoaderSupport.Validator.verifyInput(e,this.onLoadMaterials)}},THREE.LoaderSupport.LoadedMeshUserOverride=function(e,r){this.disregardMesh=!0===e,this.alteredMesh=!0===r,this.meshes=[]},THREE.LoaderSupport.LoadedMeshUserOverride.prototype={constructor:THREE.LoaderSupport.LoadedMeshUserOverride,addMesh:function(e){this.meshes.push(e),this.alteredMesh=!0},isDisregardMesh:function(){return this.disregardMesh},providesAlteredMeshes:function(){return this.alteredMesh}},THREE.LoaderSupport.ResourceDescriptor=function(e,r){var o=e.split("/");this.path,this.resourcePath,this.name=e,this.url=e,2<=o.length&&(this.path=THREE.LoaderSupport.Validator.verifyInput(o.slice(0,o.length-1).join("/")+"/",this.path),this.name=o[o.length-1],this.url=e),this.name=THREE.LoaderSupport.Validator.verifyInput(this.name,"Unnamed_Resource"),this.extension=THREE.LoaderSupport.Validator.verifyInput(r,"default"),this.extension=this.extension.trim(),this.content=null},THREE.LoaderSupport.ResourceDescriptor.prototype={constructor:THREE.LoaderSupport.ResourceDescriptor,setContent:function(e){this.content=THREE.LoaderSupport.Validator.verifyInput(e,null)},setResourcePath:function(e){this.resourcePath=THREE.LoaderSupport.Validator.verifyInput(e,this.resourcePath)}},THREE.LoaderSupport.PrepData=function(e){this.logging={enabled:!0,debug:!1},this.modelName=THREE.LoaderSupport.Validator.verifyInput(e,""),this.resources=[],this.callbacks=new THREE.LoaderSupport.Callbacks},THREE.LoaderSupport.PrepData.prototype={constructor:THREE.LoaderSupport.PrepData,setLogging:function(e,r){this.logging.enabled=!0===e,this.logging.debug=!0===r},getCallbacks:function(){return this.callbacks},addResource:function(e){this.resources.push(e)},clone:function(){var e,r,o=new THREE.LoaderSupport.PrepData(this.modelName);for(e in o.logging.enabled=this.logging.enabled,o.logging.debug=this.logging.debug,o.resources=this.resources,o.callbacks=this.callbacks,this)r=this[e],o.hasOwnProperty(e)||"function"==typeof this[e]||(o[e]=r);return o},checkResourceDescriptorFiles:function(e,r){var o,t,i,a,n={};for(var s in e)if(o=e[s],a=!1,THREE.LoaderSupport.Validator.isValid(o.name))if(THREE.LoaderSupport.Validator.isValid(o.content)){for(i=0;i<r.length&&!a;i++)if(t=r[i],o.extension.toLowerCase()===t.ext.toLowerCase())if(t.ignore)a=!0;else if("ArrayBuffer"===t.type){if(!(o.content instanceof ArrayBuffer||o.content instanceof Uint8Array))throw"Provided content is not of type ArrayBuffer! Aborting...";n[t.ext]=o,a=!0}else if("String"===t.type){if(!("string"==typeof o.content||o.content instanceof String))throw"Provided  content is not of type String! Aborting...";n[t.ext]=o,a=!0}if(!a)throw'Unidentified resource "'+o.name+'": '+o.url}else{if(!("string"==typeof o.name||o.name instanceof String))throw"Provided file is not properly defined! Aborting...";for(i=0;i<r.length&&!a;i++)t=r[i],o.extension.toLowerCase()===t.ext.toLowerCase()&&(t.ignore||(n[t.ext]=o),a=!0);if(!a)throw'Unidentified resource "'+o.name+'": '+o.url}return n}},THREE.LoaderSupport.MeshBuilder=function(){this.validator=THREE.LoaderSupport.Validator,this.logging={enabled:!0,debug:!1},this.callbacks=new THREE.LoaderSupport.Callbacks,this.materials={}},THREE.LoaderSupport.MeshBuilder.LOADER_MESH_BUILDER_VERSION="1.3.1",console.info("Using THREE.LoaderSupport.MeshBuilder version: "+THREE.LoaderSupport.MeshBuilder.LOADER_MESH_BUILDER_VERSION),THREE.LoaderSupport.MeshBuilder.prototype={constructor:THREE.LoaderSupport.MeshBuilder,setLogging:function(e,r){this.logging.enabled=!0===e,this.logging.debug=!0===r},init:function(){var e=new THREE.MeshStandardMaterial({color:14479871});e.name="defaultMaterial";var r=new THREE.MeshStandardMaterial({color:14479871});r.name="defaultVertexColorMaterial",r.vertexColors=THREE.VertexColors;var o=new THREE.LineBasicMaterial;o.name="defaultLineMaterial";var t=new THREE.PointsMaterial({size:1});t.name="defaultPointMaterial";var i={};i[e.name]=e,i[r.name]=r,i[o.name]=o,i[t.name]=t,this.updateMaterials({cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:i}})},setMaterials:function(e){var r={cmd:"materialData",materials:{materialCloneInstructions:null,serializedMaterials:null,runtimeMaterials:this.validator.isValid(this.callbacks.onLoadMaterials)?this.callbacks.onLoadMaterials(e):e}};this.updateMaterials(r)},_setCallbacks:function(e){this.validator.isValid(e.onProgress)&&this.callbacks.setCallbackOnProgress(e.onProgress),this.validator.isValid(e.onReportError)&&this.callbacks.setCallbackOnReportError(e.onReportError),this.validator.isValid(e.onMeshAlter)&&this.callbacks.setCallbackOnMeshAlter(e.onMeshAlter),this.validator.isValid(e.onLoad)&&this.callbacks.setCallbackOnLoad(e.onLoad),this.validator.isValid(e.onLoadMaterials)&&this.callbacks.setCallbackOnLoadMaterials(e.onLoadMaterials)},processPayload:function(e){return"meshData"===e.cmd?this.buildMeshes(e):"materialData"===e.cmd?(this.updateMaterials(e),null):void 0},buildMeshes:function(e){var r,o,t,i=e.params.meshName,a=new THREE.BufferGeometry;a.addAttribute("position",new THREE.BufferAttribute(new Float32Array(e.buffers.vertices),3)),this.validator.isValid(e.buffers.indices)&&a.setIndex(new THREE.BufferAttribute(new Uint32Array(e.buffers.indices),1)),this.validator.isValid(e.buffers.colors)&&a.addAttribute("color",new THREE.BufferAttribute(new Float32Array(e.buffers.colors),3)),this.validator.isValid(e.buffers.normals)?a.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(e.buffers.normals),3)):a.computeVertexNormals(),this.validator.isValid(e.buffers.uvs)&&a.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(e.buffers.uvs),2));var n=e.materials.materialNames,s=e.materials.multiMaterial,l=[];for(t in n)o=n[t],r=this.materials[o],s&&l.push(r);if(s){r=l;var u,p=e.materials.materialGroups;for(t in p)u=p[t],a.addGroup(u.start,u.count,u.index)}var d,c,h,g=[],f=this.callbacks.onMeshAlter,E=!0,R=this.validator.verifyInput(e.geometryType,0);if(this.validator.isValid(f)&&(c=f({detail:{meshName:i,bufferGeometry:a,material:r,geometryType:R}}),this.validator.isValid(c)))if(c.isDisregardMesh())E=!1;else if(c.providesAlteredMeshes()){for(var k in c.meshes)g.push(c.meshes[k]);E=!1}if(E&&(e.computeBoundingSphere&&a.computeBoundingSphere(),(d=0===R?new THREE.Mesh(a,r):1===R?new THREE.LineSegments(a,r):new THREE.Points(a,r)).name=i,g.push(d)),this.validator.isValid(g)&&0<g.length){var m=[];for(var k in g)d=g[k],m[k]=d.name;h="Adding mesh(es) ("+m.length+": "+m+") from input mesh: "+i,h+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else h="Not adding mesh: "+i,h+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";var S=this.callbacks.onProgress;this.validator.isValid(S)&&S(new CustomEvent("MeshBuilderEvent",{detail:{type:"progress",modelName:e.params.meshName,text:h,numericalValue:e.progress.numericalValue}}));return g},updateMaterials:function(e){var r,o,t=e.materials.materialCloneInstructions;if(this.validator.isValid(t)){var i=t.materialNameOrg,a=this.materials[i];if(this.validator.isValid(i)){r=a.clone(),o=t.materialName,r.name=o;var n=t.materialProperties;for(var s in n)r.hasOwnProperty(s)&&n.hasOwnProperty(s)&&(r[s]=n[s]);this.materials[o]=r}else console.warn('Requested material "'+i+'" is not available!')}var l=e.materials.serializedMaterials;if(this.validator.isValid(l)&&0<Object.keys(l).length){var u,p=new THREE.MaterialLoader;for(o in l)u=l[o],this.validator.isValid(u)&&(r=p.parse(u),this.logging.enabled&&console.info('De-serialized material with name "'+o+'" will be added.'),this.materials[o]=r)}if(l=e.materials.runtimeMaterials,this.validator.isValid(l)&&0<Object.keys(l).length)for(o in l)r=l[o],this.logging.enabled&&console.info('Material with name "'+o+'" will be added.'),this.materials[o]=r},getMaterialsJSON:function(){var e,r={};for(var o in this.materials)e=this.materials[o],r[o]=e.toJSON();return r},getMaterials:function(){return this.materials}},THREE.LoaderSupport.WorkerSupport=function(){this.logging={enabled:!0,debug:!1},this.loaderWorker="undefined"!=typeof window?new THREE.LoaderSupport.WorkerSupport.LoaderWorker:new THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker},THREE.LoaderSupport.WorkerSupport.WORKER_SUPPORT_VERSION="2.3.0",console.info("Using THREE.LoaderSupport.WorkerSupport version: "+THREE.LoaderSupport.WorkerSupport.WORKER_SUPPORT_VERSION),THREE.LoaderSupport.WorkerSupport.prototype={constructor:THREE.LoaderSupport.WorkerSupport,setLogging:function(e,r){this.logging.enabled=!0===e,this.logging.debug=!0===r,this.loaderWorker.setLogging(this.logging.enabled,this.logging.debug)},setForceWorkerDataCopy:function(e){this.loaderWorker.setForceCopy(e)},validate:function(e,r,o,t,i){if(!THREE.LoaderSupport.Validator.isValid(this.loaderWorker.worker)){this.logging.enabled&&(console.info("WorkerSupport: Building worker code..."),console.time("buildWebWorkerCode")),THREE.LoaderSupport.Validator.isValid(i)?this.logging.enabled&&console.info('WorkerSupport: Using "'+i.runnerName+'" as Runner class for worker.'):"undefined"!=typeof window?(i=THREE.LoaderSupport.WorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "THREE.LoaderSupport.WorkerRunnerRefImpl" as Runner class for worker.')):(i=THREE.LoaderSupport.NodeWorkerRunnerRefImpl,this.logging.enabled&&console.info('WorkerSupport: Using DEFAULT "THREE.LoaderSupport.NodeWorkerRunnerRefImpl" as Runner class for worker.'));var a=e(THREE.LoaderSupport.WorkerSupport.CodeSerializer);a+="var Parser = "+r+";\n\n",a+=THREE.LoaderSupport.WorkerSupport.CodeSerializer.serializeClass(i.runnerName,i),a+="new "+i.runnerName+"();\n\n";var n=this;if(THREE.LoaderSupport.Validator.isValid(o)&&0<o.length){var s="",l=function(r,o){if(0===o.length)n.loaderWorker.initWorker(s+a,i.runnerName),n.logging.enabled&&console.timeEnd("buildWebWorkerCode");else{var e=new THREE.FileLoader;e.setPath(r),e.setResponseType("text"),e.load(o[0],function(e){s+=e,l(r,o)}),o.shift()}};l(t,o)}else this.loaderWorker.initWorker(a,i.runnerName),this.logging.enabled&&console.timeEnd("buildWebWorkerCode")}},setCallbacks:function(e,r){this.loaderWorker.setCallbacks(e,r)},run:function(e){this.loaderWorker.run(e)},setTerminateRequested:function(e){this.loaderWorker.setTerminateRequested(e)}},THREE.LoaderSupport.WorkerSupport.LoaderWorker=function(){this._reset()},THREE.LoaderSupport.WorkerSupport.LoaderWorker.prototype={constructor:THREE.LoaderSupport.WorkerSupport.LoaderWorker,_reset:function(){this.logging={enabled:!0,debug:!1},this.worker=null,this.runnerImplName=null,this.callbacks={meshBuilder:null,onLoad:null},this.terminateRequested=!1,this.queuedMessage=null,this.started=!1,this.forceCopy=!1},checkSupport:function(){return void 0===window.Worker?"This browser does not support web workers!":void 0===window.Blob?"This browser does not support Blob!":"function"!=typeof window.URL.createObjectURL?"This browser does not support Object creation from URL!":void 0},setLogging:function(e,r){this.logging.enabled=!0===e,this.logging.debug=!0===r},setForceCopy:function(e){this.forceCopy=!0===e},initWorker:function(e,r){var o=this.checkSupport();if(o)throw o;this.runnerImplName=r;var t=new Blob([e],{type:"application/javascript"});this.worker=new Worker(window.URL.createObjectURL(t)),this.worker.onmessage=this._receiveWorkerMessage,(this.worker.runtimeRef=this)._postMessage()},_receiveWorkerMessage:function(e){var r=e.data;switch(r.cmd){case"meshData":case"materialData":case"imageData":this.runtimeRef.callbacks.meshBuilder(r);break;case"complete":this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(r.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run is complete. Terminating application on request!"),this.runtimeRef._terminate());break;case"error":console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Reported error: "+r.msg),this.runtimeRef.queuedMessage=null,this.started=!1,this.runtimeRef.callbacks.onLoad(r.msg),this.runtimeRef.terminateRequested&&(this.runtimeRef.logging.enabled&&console.info("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Run reported error. Terminating application on request!"),this.runtimeRef._terminate());break;default:console.error("WorkerSupport ["+this.runtimeRef.runnerImplName+"]: Received unknown command: "+r.cmd)}},setCallbacks:function(e,r){this.callbacks.meshBuilder=THREE.LoaderSupport.Validator.verifyInput(e,this.callbacks.meshBuilder),this.callbacks.onLoad=THREE.LoaderSupport.Validator.verifyInput(r,this.callbacks.onLoad)},run:function(e){if(THREE.LoaderSupport.Validator.isValid(this.queuedMessage))console.warn("Already processing message. Rejecting new run instruction");else{if(this.queuedMessage=e,this.started=!0,!THREE.LoaderSupport.Validator.isValid(this.callbacks.meshBuilder))throw'Unable to run as no "MeshBuilder" callback is set.';if(!THREE.LoaderSupport.Validator.isValid(this.callbacks.onLoad))throw'Unable to run as no "onLoad" callback is set.';"run"!==e.cmd&&(e.cmd="run"),THREE.LoaderSupport.Validator.isValid(e.logging)?(e.logging.enabled=!0===e.logging.enabled,e.logging.debug=!0===e.logging.debug):e.logging={enabled:!0,debug:!1},this._postMessage()}},_postMessage:function(){var e;THREE.LoaderSupport.Validator.isValid(this.queuedMessage)&&THREE.LoaderSupport.Validator.isValid(this.worker)&&(this.queuedMessage.data.input instanceof ArrayBuffer?(e=this.forceCopy?this.queuedMessage.data.input.slice(0):this.queuedMessage.data.input,this.worker.postMessage(this.queuedMessage,[e])):this.worker.postMessage(this.queuedMessage))},setTerminateRequested:function(e){this.terminateRequested=!0===e,this.terminateRequested&&THREE.LoaderSupport.Validator.isValid(this.worker)&&!THREE.LoaderSupport.Validator.isValid(this.queuedMessage)&&this.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate())},_terminate:function(){this.worker.terminate(),this._reset()}},THREE.LoaderSupport.WorkerSupport.CodeSerializer={serializeObject:function(e,r){var o,t=e+" = {\n\n";for(var i in r)"string"==typeof(o=r[i])||o instanceof String?t+="\t"+i+': "'+(o=(o=o.replace("\n","\\n")).replace("\r","\\r"))+'",\n':o instanceof Array?t+="\t"+i+": ["+o+"],\n":t+="object"==typeof o?"\t"+i+": {},\n":"\t"+i+": "+o+",\n";return t+="}\n\n"},serializeClass:function(e,r,o,t,i,a,n){var s,l,u,p,d,c=[],h=[],g=[],f=null!=t;for(var E in Array.isArray(i)||(i=[]),Array.isArray(a)||(a=null),Array.isArray(n)||(n=[]),r.prototype)s=(l=r.prototype[E]).toString(),"constructor"===E?u=e+" = "+s+";\n\n":"function"==typeof l&&i.indexOf(E)<0&&(null===a||0<=a.indexOf(E))&&((d=n[E])&&d.fullName===e+".prototype."+E&&(s=d.code),f?c.push(e+".prototype."+E+" = "+s+";\n\n"):c.push("\t"+E+": "+s+",\n\n"));for(var E in r)"function"==typeof(l=r[E])?i.indexOf(E)<0&&(null===a||0<=a.indexOf(E))&&(s=(d=n[E])&&d.fullName===e+"."+E?d.code:l.toString(),g.push(e+"."+E+" = "+s+";\n\n")):(s="string"==typeof l||l instanceof String?'"'+l.toString()+'"':"object"==typeof l?"{}":l,h.push(e+"."+E+" = "+s+";\n"));null==u&&"function"==typeof r.prototype.constructor&&(u=e+" = "+r.prototype.constructor.toString().replace(o,""));var R=u+"\n\n";for(f&&(R+=e+".prototype = Object.create( "+t+".prototype );\n"),R+=e+".prototype.constructor = "+e+";\n",R+="\n\n",p=0;p<h.length;p++)R+=h[p];for(R+="\n\n",p=0;p<g.length;p++)R+=g[p];if(R+="\n\n",f)for(p=0;p<c.length;p++)R+=c[p];else{for(R+=e+".prototype = {\n\n",p=0;p<c.length;p++)R+=c[p];R+="\n};"}return R+="\n\n"}},THREE.LoaderSupport.WorkerRunnerRefImpl=function(){this.getParentScope().addEventListener("message",function(e){this.processMessage(e.data)}.bind(this))},THREE.LoaderSupport.WorkerRunnerRefImpl.runnerName="THREE.LoaderSupport.WorkerRunnerRefImpl",THREE.LoaderSupport.WorkerRunnerRefImpl.prototype={constructor:THREE.LoaderSupport.WorkerRunnerRefImpl,getParentScope:function(){return self},applyProperties:function(e,r){var o,t,i;for(o in r)t="set"+o.substring(0,1).toLocaleUpperCase()+o.substring(1),i=r[o],"function"==typeof e[t]?e[t](i):e.hasOwnProperty(o)&&(e[o]=i)},processMessage:function(r){if("run"===r.cmd){var o=this.getParentScope(),e={callbackOnAssetAvailable:function(e){o.postMessage(e)},callbackOnProgress:function(e){r.logging.enabled&&r.logging.debug&&console.debug("WorkerRunner: progress: "+e)}},t=new Parser;"function"==typeof t.setLogging&&t.setLogging(r.logging.enabled,r.logging.debug),this.applyProperties(t,r.params),this.applyProperties(t,r.materials),this.applyProperties(t,e),t.workerScope=o,t.parse(r.data.input,r.data.options),r.logging.enabled&&console.log("WorkerRunner: Run complete!"),e.callbackOnAssetAvailable({cmd:"complete",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+r.cmd)}},THREE.LoaderSupport.NodeWorkerRunnerRefImpl=function(){this.runnerName="THREE.LoaderSupport.NodeWorkerRunnerRefImpl",this.getParentScope().onmessage=this.processMessage.bind(this)},THREE.LoaderSupport.NodeWorkerRunnerRefImpl.prototype=Object.create(THREE.LoaderSupport.WorkerRunnerRefImpl.prototype),THREE.LoaderSupport.NodeWorkerRunnerRefImpl.prototype.constructor=THREE.LoaderSupport.NodeWorkerRunnerRefImpl,THREE.LoaderSupport.NodeWorkerRunnerRefImpl.runnerName="THREE.LoaderSupport.NodeWorkerRunnerRefImpl",THREE.LoaderSupport.NodeWorkerRunnerRefImpl.prototype={getParentScope:function(){var _require=eval("require");return _require("worker_threads").parentPort}},THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker=function(){THREE.LoaderSupport.WorkerSupport.LoaderWorker.call(this)},THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype=Object.create(THREE.LoaderSupport.WorkerSupport.LoaderWorker.prototype),THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype.constructor=THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker,THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker.checkSupport=function(){try{var _require=eval("require");_require.resolve("worker_threads")}catch(e){return"This version of Node does not support web workers!"}},THREE.LoaderSupport.WorkerSupport.NodeLoaderWorker.prototype.initWorker=function(code,runnerImplName){var supportError=this.checkSupport();if(supportError)throw supportError;this.runnerImplName=runnerImplName;var _require=eval("require"),Worker=_require("worker_threads").Worker;this.worker=new Worker(code,{eval:!0}),this.worker.onmessage=this._receiveWorkerMessage,this.worker.runtimeRef=this,this._postMessage()},THREE.LoaderSupport.WorkerDirector=function(e){if(this.logging={enabled:!0,debug:!1},this.maxQueueSize=THREE.LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE,this.maxWebWorkers=THREE.LoaderSupport.WorkerDirector.MAX_WEB_WORKER,this.crossOrigin=null,!THREE.LoaderSupport.Validator.isValid(e))throw"Provided invalid classDef: "+e;this.workerDescription={classDef:e,globalCallbacks:{},workerSupports:{},forceWorkerDataCopy:!0},this.objectsCompleted=0,this.instructionQueue=[],this.instructionQueuePointer=0,this.callbackOnFinishedProcessing=null},THREE.LoaderSupport.WorkerDirector.LOADER_WORKER_DIRECTOR_VERSION="2.3.0",THREE.LoaderSupport.WorkerDirector.MAX_WEB_WORKER=16,THREE.LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE=2048,console.info("Using THREE.LoaderSupport.WorkerDirector version: "+THREE.LoaderSupport.WorkerDirector.LOADER_WORKER_DIRECTOR_VERSION),THREE.LoaderSupport.WorkerDirector.prototype={constructor:THREE.LoaderSupport.WorkerDirector,setLogging:function(e,r){this.logging.enabled=!0===e,this.logging.debug=!0===r},getMaxQueueSize:function(){return this.maxQueueSize},getMaxWebWorkers:function(){return this.maxWebWorkers},setCrossOrigin:function(e){this.crossOrigin=e},setForceWorkerDataCopy:function(e){this.workerDescription.forceWorkerDataCopy=!0===e},prepareWorkers:function(e,r,o){THREE.LoaderSupport.Validator.isValid(e)&&(this.workerDescription.globalCallbacks=e),this.maxQueueSize=Math.min(r,THREE.LoaderSupport.WorkerDirector.MAX_QUEUE_SIZE),this.maxWebWorkers=Math.min(o,THREE.LoaderSupport.WorkerDirector.MAX_WEB_WORKER),this.maxWebWorkers=Math.min(this.maxWebWorkers,this.maxQueueSize),this.objectsCompleted=0,this.instructionQueue=[];for(var t=this.instructionQueuePointer=0;t<this.maxWebWorkers;t++){var i=new THREE.LoaderSupport.WorkerSupport;i.setLogging(this.logging.enabled,this.logging.debug),i.setForceWorkerDataCopy(this.workerDescription.forceWorkerDataCopy),this.workerDescription.workerSupports[t]={instanceNo:t,inUse:!1,terminateRequested:!1,workerSupport:i,loader:null}}},enqueueForRun:function(e){this.instructionQueue.length<this.maxQueueSize&&this.instructionQueue.push(e)},isRunning:function(){var e=Object.keys(this.workerDescription.workerSupports);return 0<this.instructionQueue.length&&this.instructionQueuePointer<this.instructionQueue.length||0<e.length},processQueue:function(){var e,r;for(var o in this.workerDescription.workerSupports)(r=this.workerDescription.workerSupports[o]).inUse||(this.instructionQueuePointer<this.instructionQueue.length?(e=this.instructionQueue[this.instructionQueuePointer],this._kickWorkerRun(e,r),this.instructionQueuePointer++):this._deregister(r));this.isRunning()||null===this.callbackOnFinishedProcessing||(this.callbackOnFinishedProcessing(),this.callbackOnFinishedProcessing=null)},_kickWorkerRun:function(e,o){o.inUse=!0,o.workerSupport.setTerminateRequested(o.terminateRequested),this.logging.enabled&&console.info("\nAssigning next item from queue to worker (queue length: "+this.instructionQueue.length+")\n\n");var t=THREE.LoaderSupport.Validator,i=this,a=e.getCallbacks(),n=this.workerDescription.globalCallbacks;o.loader=this._buildLoader(o.instanceNo);var r=new THREE.LoaderSupport.Callbacks;r.setCallbackOnLoad(function(e){t.isValid(n.onLoad)&&n.onLoad(e),t.isValid(a.onLoad)&&a.onLoad(e),i.objectsCompleted++,o.inUse=!1,i.processQueue()}),r.setCallbackOnProgress(function(e){t.isValid(n.onProgress)&&n.onProgress(e),t.isValid(a.onProgress)&&a.onProgress(e)}),r.setCallbackOnReportError(function(e){var r=!0;t.isValid(n.onReportError)&&(r=n.onReportError(o,e)),t.isValid(a.onReportError)&&(r=a.onReportError(o,e)),t.isValid(n.onReportError)||t.isValid(a.onReportError)||(console.error("Loader reported an error: "),console.error(e)),r&&(o.inUse=!1,i.processQueue())}),r.setCallbackOnMeshAlter(function(e,r){return t.isValid(n.onMeshAlter)&&(r=n.onMeshAlter(e,r)),t.isValid(a.onMeshAlter)&&(r=n.onMeshAlter(e,r)),r}),r.setCallbackOnLoadMaterials(function(e){return t.isValid(n.onLoadMaterials)&&(e=n.onLoadMaterials(e)),t.isValid(a.onLoadMaterials)&&(e=a.onLoadMaterials(e)),e}),e.callbacks=r,o.loader.run(e,o.workerSupport)},_buildLoader:function(e){var r=this.workerDescription.classDef,o=Object.create(r.prototype);if(r.call(o,THREE.DefaultLoadingManager),!o.hasOwnProperty("instanceNo"))throw r.name+' has no property "instanceNo".';if(o.instanceNo=e,!o.hasOwnProperty("workerSupport"))throw r.name+' has no property "workerSupport".';if("function"!=typeof o.run)throw r.name+' has no function "run".';return o.hasOwnProperty("callbacks")&&THREE.LoaderSupport.Validator.isValid(o.callbacks)||(console.warn(r.name+' has an invalid property "callbacks". Will change to "THREE.LoaderSupport.Callbacks"'),o.callbacks=new THREE.LoaderSupport.Callbacks),o},_deregister:function(e){if(THREE.LoaderSupport.Validator.isValid(e)){e.workerSupport.setTerminateRequested(!0),this.logging.enabled&&console.info("Requested termination of worker #"+e.instanceNo+".");var r=e.loader.callbacks;THREE.LoaderSupport.Validator.isValid(r.onProgress)&&r.onProgress({detail:{text:""}}),delete this.workerDescription.workerSupports[e.instanceNo]}},tearDown:function(e){for(var r in this.logging.enabled&&console.info("WorkerDirector received the deregister call. Terminating all workers!"),this.instructionQueuePointer=this.instructionQueue.length,this.callbackOnFinishedProcessing=THREE.LoaderSupport.Validator.verifyInput(e,null),this.workerDescription.workerSupports)this.workerDescription.workerSupports[r].terminateRequested=!0}};
THREE.EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var i={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1},r=e.getSize(new THREE.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,(t=new THREE.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===THREE.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new THREE.ShaderPass(THREE.CopyShader),this.clock=new THREE.Clock},Object.assign(THREE.EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new THREE.Vector2);e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,i,r=this.renderer.getRenderTarget(),s=!1,h=this.passes.length;for(i=0;i<h;i++)if(!1!==(t=this.passes[i]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,s),t.needsSwap){if(s){var n=this.renderer.context;n.stencilFunc(n.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.stencilFunc(n.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==THREE.MaskPass&&(t instanceof THREE.MaskPass?s=!0:t instanceof THREE.ClearMaskPass&&(s=!1))}this.renderer.setRenderTarget(r)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new THREE.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(var s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}),THREE.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(THREE.Pass.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),THREE.Pass.FullScreenQuad=function(){function e(e){this._mesh=new THREE.Mesh(i,e)}var t=new THREE.OrthographicCamera(-1,1,1,-1,0,1),i=new THREE.PlaneBufferGeometry(2,2);return Object.defineProperty(e.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(e.prototype,{render:function(e){e.render(this._mesh,t)}}),e}();
THREE.RenderPass=function(e,r,a,t,l){THREE.Pass.call(this),this.scene=e,this.camera=r,this.overrideMaterial=a,this.clearColor=t,this.clearAlpha=void 0!==l?l:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},THREE.RenderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.RenderPass,render:function(e,r,a){var t,l,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(t=e.getClearColor().getHex(),l=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:a),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(t,l),this.scene.overrideMaterial=null,e.autoClear=s}});
THREE.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};
THREE.DotScreenShader={uniforms:{tDiffuse:{value:null},tSize:{value:new THREE.Vector2(256,256)},center:{value:new THREE.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","float s = sin( angle ), c = cos( angle );","vec2 tex = vUv * tSize - center;","vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","return ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","vec4 color = texture2D( tDiffuse, vUv );","float average = ( color.r + color.g + color.b ) / 3.0;","gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};
THREE.DotScreenPass=function(e,r,t){THREE.Pass.call(this),void 0===THREE.DotScreenShader&&console.error("THREE.DotScreenPass relies on THREE.DotScreenShader");var s=THREE.DotScreenShader;this.uniforms=THREE.UniformsUtils.clone(s.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==r&&(this.uniforms.angle.value=r),void 0!==t&&(this.uniforms.scale.value=t),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:s.vertexShader,fragmentShader:s.fragmentShader}),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material)},THREE.DotScreenPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.DotScreenPass,render:function(e,r,t){this.uniforms.tDiffuse.value=t.texture,this.uniforms.tSize.value.set(t.width,t.height),this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(r),this.clear&&e.clear()),this.fsQuad.render(e)}});
THREE.FilmShader={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 cTextureScreen = texture2D( tDiffuse, vUv );","float dx = rand( vUv + time );","vec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","vec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","cResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","cResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","if( grayscale ) {","cResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","}","gl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};
THREE.DigitalGlitch={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","if(byp<1) {","vec2 p = vUv;","float xs = floor(gl_FragCoord.x / 0.5);","float ys = floor(gl_FragCoord.y / 0.5);","vec4 normal = texture2D (tDisp, p*seed*seed);","if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","if(seed_x>0.){","p.y = 1. - (p.y + distortion_y);","}","else {","p.y = distortion_y;","}","}","if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","if(seed_y>0.){","p.x=distortion_x;","}","else {","p.x = 1. - (p.x + distortion_x);","}","}","p.x+=normal.x*seed_x*(seed/5.);","p.y+=normal.y*seed_y*(seed/5.);","vec2 offset = amount * vec2( cos(angle), sin(angle));","vec4 cr = texture2D(tDiffuse, p + offset);","vec4 cga = texture2D(tDiffuse, p);","vec4 cb = texture2D(tDiffuse, p - offset);","gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","gl_FragColor = gl_FragColor+ snow;","}","else {","gl_FragColor=texture2D (tDiffuse, vUv);","}","}"].join("\n")};
THREE.MaskPass=function(e,s){THREE.Pass.call(this),this.scene=e,this.camera=s,this.clear=!0,this.needsSwap=!1,this.inverse=!1},THREE.MaskPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.MaskPass,render:function(e,s,t){var r,a,c=e.context,n=e.state;n.buffers.color.setMask(!1),n.buffers.depth.setMask(!1),n.buffers.color.setLocked(!0),n.buffers.depth.setLocked(!0),a=this.inverse?(r=0,1):(r=1,0),n.buffers.stencil.setTest(!0),n.buffers.stencil.setOp(c.REPLACE,c.REPLACE,c.REPLACE),n.buffers.stencil.setFunc(c.ALWAYS,r,4294967295),n.buffers.stencil.setClear(a),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(s),this.clear&&e.clear(),e.render(this.scene,this.camera),n.buffers.color.setLocked(!1),n.buffers.depth.setLocked(!1),n.buffers.stencil.setFunc(c.EQUAL,1,4294967295),n.buffers.stencil.setOp(c.KEEP,c.KEEP,c.KEEP)}}),THREE.ClearMaskPass=function(){THREE.Pass.call(this),this.needsSwap=!1},THREE.ClearMaskPass.prototype=Object.create(THREE.Pass.prototype),Object.assign(THREE.ClearMaskPass.prototype,{render:function(e){e.state.buffers.stencil.setTest(!1)}});
THREE.ShaderPass=function(e,t){THREE.Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof THREE.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=THREE.UniformsUtils.clone(e.uniforms),this.material=new THREE.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material)},THREE.ShaderPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.ShaderPass,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}});
THREE.GlitchPass=function(t){THREE.Pass.call(this),void 0===THREE.DigitalGlitch&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var a=THREE.DigitalGlitch;this.uniforms=THREE.UniformsUtils.clone(a.uniforms),null==t&&(t=64),this.uniforms.tDisp.value=this.generateHeightmap(t),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()},THREE.GlitchPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.GlitchPass,render:function(t,a,e){this.uniforms.tDiffuse.value=e.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=THREE.Math.randFloat(-1,1),this.uniforms.seed_y.value=THREE.Math.randFloat(-1,1),this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.uniforms.seed_x.value=THREE.Math.randFloat(-.3,.3),this.uniforms.seed_y.value=THREE.Math.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(a),this.clear&&t.clear()),this.fsQuad.render(t)},generateTrigger:function(){this.randX=THREE.Math.randInt(120,240)},generateHeightmap:function(t){for(var a=new Float32Array(t*t*3),e=t*t,r=0;r<e;r++){var i=THREE.Math.randFloat(0,1);a[3*r+0]=i,a[3*r+1]=i,a[3*r+2]=i}var s=new THREE.DataTexture(a,t,t,THREE.RGBFormat,THREE.FloatType);return s.needsUpdate=!0,s}});
THREE.FilmPass=function(e,s,r,i){THREE.Pass.call(this),void 0===THREE.FilmShader&&console.error("THREE.FilmPass relies on THREE.FilmShader");var t=THREE.FilmShader;this.uniforms=THREE.UniformsUtils.clone(t.uniforms),this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),void 0!==i&&(this.uniforms.grayscale.value=i),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==s&&(this.uniforms.sIntensity.value=s),void 0!==r&&(this.uniforms.sCount.value=r),this.fsQuad=new THREE.Pass.FullScreenQuad(this.material)},THREE.FilmPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.FilmPass,render:function(e,s,r,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=i,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(s),this.clear&&e.clear()),this.fsQuad.render(e)}});

